(function(){"use strict";var t={6110:function(t,e,r){var s=r(6369),a=function(){var t=this,e=t._self._c;return e("router-view")},i=[],o=r(1001),n={},l=(0,o.Z)(n,a,i,!1,null,null,null),c=l.exports,u=r(2631),d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page__wrapper"},[e("BaseHeader"),e("div",{staticClass:"not-found container"},[t._m(0),e("RouterLink",{staticClass:"not-found__backlink",attrs:{to:{name:"home"}}},[t._v("⊲ Вернуться назад")])],1),e("BaseFooter")],1)},_=[function(){var t=this,e=t._self._c;return e("h1",{staticClass:"not-found__title"},[e("b",{staticClass:"not-found__num"},[t._v("404")]),e("span",{staticClass:"not-found__message"},[t._v("Страница не найдена")])])}],m=function(){var t=this,e=t._self._c;return e("header",{staticClass:"header container"},[e("div",{staticClass:"header__wrapper"},[e("span",{staticClass:"header__info"},[t._v("Каталог")]),e("RouterLink",{staticClass:"header__logo",attrs:{href:"#",to:{name:"home"}}},[e("img",{attrs:{src:"img/svg/logo-moire.svg",alt:"Логотип интернет магазина Moire",width:"116",height:"34"}})]),e("a",{staticClass:"header__tel",attrs:{href:"tel:8 800 600 90 09"}},[t._v(" 8 800 600 90 09 ")]),e("RouterLink",{staticClass:"header__cart",attrs:{href:"cart.html","aria-label":"Корзина с товарами",to:{name:"cart"}}},[e("svg",{attrs:{width:"19",height:"24"}},[e("use",{attrs:{"xlink:href":"#icon-cart"}})]),e("CartIndicator")],1)],1)])},p=[],h=function(){var t=this,e=t._self._c;return e("span",{staticClass:"header__count",attrs:{"aria-label":"Количество товаров"}},[t._v(t._s(t.productsLength))])},f=[],g=r(3822),v={name:"ProjectCartIndicator",computed:{...(0,g.Se)(["productsLength"])},methods:{...(0,g.nv)(["getCartProducts"])},created(){this.getCartProducts()}},C=v,y=(0,o.Z)(C,h,f,!1,null,null,null),b=y.exports,k={components:{RouterLink:u.rH,CartIndicator:b}},P=k,w=(0,o.Z)(P,m,p,!1,null,null,null),I=w.exports,x=function(){var t=this,e=t._self._c;return e("footer",{staticClass:"footer container"},[e("div",{staticClass:"footer__wrapper"},[t._m(0),e("ul",{staticClass:"footer__social social"},[e("li",{staticClass:"social__item"},[e("a",{staticClass:"social__link",attrs:{href:"#","aria-label":"Вконтакте"}},[e("svg",{attrs:{width:"20",height:"11",fill:"currentColor"}},[e("use",{attrs:{"xlink:href":"#icon-vk"}})])])]),e("li",{staticClass:"social__item"},[e("a",{staticClass:"social__link",attrs:{href:"#","aria-label":"Инстаграм"}},[e("svg",{attrs:{width:"17",height:"17",fill:"currentColor"}},[e("use",{attrs:{"xlink:href":"#icon-insta"}})])])]),e("li",{staticClass:"social__item"},[e("a",{staticClass:"social__link",attrs:{href:"#","aria-label":"Facebook"}},[e("svg",{attrs:{width:"17",height:"17",fill:"currentColor"}},[e("use",{attrs:{"xlink:href":"#icon-facebook"}})])])]),e("li",{staticClass:"social__item"},[e("a",{staticClass:"social__link",attrs:{href:"#","aria-label":"Twitter"}},[e("svg",{attrs:{width:"17",height:"14",fill:"currentColor"}},[e("use",{attrs:{"xlink:href":"#icon-twitter"}})])])]),e("li",{staticClass:"social__item"},[e("a",{staticClass:"social__link",attrs:{href:"#","aria-label":"Telegram"}},[e("svg",{attrs:{width:"19",height:"17",fill:"currentColor"}},[e("use",{attrs:{"xlink:href":"#icon-telegram"}})])])])]),e("p",{staticClass:"footer__desc"},[t._v(" Все права на материалы, находящиеся на сайте, охраняются в соответствии с законодательством РФ, в том числе об авторском праве и смежных правах. ")]),t._m(1),e("span",{staticClass:"footer__copyright"},[t._v(" © 2020 Moire ")])])])},D=[function(){var t=this,e=t._self._c;return e("ul",{staticClass:"footer__links"},[e("li",[e("a",{staticClass:"footer__link",attrs:{href:"#"}},[t._v(" Каталог ")])]),e("li",[e("a",{staticClass:"footer__link",attrs:{href:"tel:88006009009"}},[t._v(" 8 800 600 90 09 ")])]),e("li",[e("a",{staticClass:"footer__link",attrs:{href:"mailto:hi@technozavrrr.com"}},[t._v(" hi@technozavrrr.com ")])]),e("li",[e("a",{staticClass:"footer__link",attrs:{href:"#"}},[t._v(" Распродажа ")])]),e("li",[e("a",{staticClass:"footer__link footer__link--medium",attrs:{href:"#"}},[t._v(" Заказать звонок ")])])])},function(){var t=this,e=t._self._c;return e("ul",{staticClass:"footer__data"},[e("li",[e("a",{staticClass:"footer__link",attrs:{href:"#",target:"_blank",rel:"noopener",type:"application/pdf"}},[t._v(" Политика конфиденциальности ")])]),e("li",[e("a",{staticClass:"footer__link",attrs:{href:"#",target:"_blank",rel:"noopener",type:"application/pdf"}},[t._v(" Публичная оферта ")])])])}],A={},F=A,L=(0,o.Z)(F,x,D,!1,null,null,null),B=L.exports,S={components:{BaseHeader:I,BaseFooter:B,RouterLink:u.rH}},T=S,z=(0,o.Z)(T,d,_,!1,null,"4c1d936e",null),R=z.exports,K=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page__wrapper"},[e("BaseHeader"),e("main",{staticClass:"content container"},[e("div",{staticClass:"content__top"},[e("div",{staticClass:"content__row"},[e("h1",{staticClass:"content__title"},[t._v("Каталог")]),e("span",{staticClass:"content__info"},[t._v(" "+t._s(t.productsCount)+" "+t._s(t._f("normalizeWord")("товар",t.productsCount)))])])]),e("div",{staticClass:"content__catalog"},[e("ProductFilter",{attrs:{seasons:t.seasons,categories:t.categories,materials:t.materials,colors:t.colors,isFilterLoading:t.isFilterLoading},on:{"filter-update":t.handleFilterUpdate}}),e("section",{staticClass:"catalog with-preloader"},[t.products.length?e("ul",{staticClass:"catalog__list"},t._l(t.products,(function(t){return e("ProductItem",{key:t.id,attrs:{product:t}})})),1):t._e(),e("BasePagination",{attrs:{pageCurrent:t.pageCurrent,pagesCount:t.pagesTotal},on:{"update:pageCurrent":function(e){t.pageCurrent=e},"update:page-current":function(e){t.pageCurrent=e}}}),t.catalogPreloaderVisible?e("BasePreloader"):t._e()],1)],1)]),e("BaseFooter")],1)},N=[],Z=function(){var t=this,e=t._self._c;return e("li",{staticClass:"catalog__item"},[e("RouterLink",{staticClass:"catalog__pic",attrs:{to:{name:"product",params:{id:t.product.slug}}}},[e("img",{attrs:{src:t.imgUrls[t.currentColorIndex]||t.placeholderImg,alt:t.product.title}})]),e("h3",{staticClass:"catalog__title"},[e("a",{attrs:{href:"#"}},[t._v(" "+t._s(t.product.title)+" ")])]),e("span",{staticClass:"catalog__price"},[t._v(" "+t._s(t._f("numberFormat")(t.product.price))+" ₽ ")]),e("ul",{staticClass:"colors colors--black"},t._l(t.product.colors,(function(r,s){return e("li",{key:r.color.id,staticClass:"colors__item"},[e("label",{staticClass:"colors__label"},[e("input",{staticClass:"colors__radio sr-only",attrs:{type:"radio",name:t.product.id+"color"},domProps:{value:r.color.code,checked:s===t.currentColorIndex},on:{click:function(e){return t.setCurrentColorIndex(s)}}}),e("span",{staticClass:"colors__value",style:{backgroundColor:r.color.code}})])])})),0)],1)},$=[];function V(t){return(new Intl.NumberFormat).format(t)}var M=r.p+"img/product-placeholder.c0316645.jpg",E={data(){return{placeholderImg:M}}},O={name:"ProductItem",components:{RouterLink:u.rH},mixins:[E],props:["product"],data(){return{currentColorIndex:0}},methods:{setCurrentColorIndex(t){this.currentColorIndex=t}},computed:{imgUrls(){const t=this.product?.colors;return t&&t.length?t.map((t=>{const e=t.gallery;if(e&&e.length)return e[0].file.url})):[]}},filters:{numberFormat:V}},q=O,H=(0,o.Z)(q,Z,$,!1,null,null,null),U=H.exports,j=function(){var t=this,e=t._self._c;return e("aside",{staticClass:"filter"},[e("form",{staticClass:"filter__form form",attrs:{action:"#",method:"get"},on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}}},[e("fieldset",{staticClass:"form__block"},[e("legend",{staticClass:"form__legend"},[t._v("Цена")]),e("label",{staticClass:"form__label form__label--price"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.validPriceFrom,expression:"validPriceFrom",modifiers:{number:!0}}],staticClass:"form__input",attrs:{type:"number",name:"min-price",placeholder:"0",disabled:t.isFilterLoading},domProps:{value:t.validPriceFrom},on:{input:function(e){e.target.composing||(t.validPriceFrom=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),e("span",{staticClass:"form__value"},[t._v("От")])]),e("label",{staticClass:"form__label form__label--price"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.validPriceTo,expression:"validPriceTo",modifiers:{number:!0}}],staticClass:"form__input",attrs:{type:"text",name:"max-price",placeholder:"250000",disabled:t.isFilterLoading},domProps:{value:t.validPriceTo},on:{input:function(e){e.target.composing||(t.validPriceTo=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),e("span",{staticClass:"form__value"},[t._v("До")])])]),e("fieldset",{staticClass:"form__block"},[e("legend",{staticClass:"form__legend"},[t._v("Категория")]),e("label",{staticClass:"form__label form__label--select"},[e("select",{directives:[{name:"model",rawName:"v-model.number",value:t.currentCategoryId,expression:"currentCategoryId",modifiers:{number:!0}}],staticClass:"form__select",attrs:{type:"number",name:"category",disabled:t.isFilterLoading},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(e){var r="_value"in e?e._value:e.value;return t._n(r)}));t.currentCategoryId=e.target.multiple?r:r[0]}}},[e("option",{attrs:{value:"0"}},[t._v("Все категории")]),t._l(t.categories,(function(r){return e("option",{key:r.id,domProps:{value:r.id}},[t._v(" "+t._s(r.title)+" ")])}))],2)])]),e("fieldset",{staticClass:"form__block"},[e("legend",{staticClass:"form__legend"},[t._v("Цвет")]),e("ul",{staticClass:"colors"},t._l(t.colors,(function(r){return e("li",{key:r.code,staticClass:"colors__item"},[e("label",{staticClass:"colors__label color-interactive"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.checkedColors,expression:"checkedColors",modifiers:{number:!0}}],staticClass:"colors__radio sr-only",attrs:{type:"checkbox",name:"color",disabled:t.isFilterLoading},domProps:{value:r.id,checked:Array.isArray(t.checkedColors)?t._i(t.checkedColors,r.id)>-1:t.checkedColors},on:{change:function(e){var s=t.checkedColors,a=e.target,i=!!a.checked;if(Array.isArray(s)){var o=t._n(r.id),n=t._i(s,o);a.checked?n<0&&(t.checkedColors=s.concat([o])):n>-1&&(t.checkedColors=s.slice(0,n).concat(s.slice(n+1)))}else t.checkedColors=i}}}),e("span",{staticClass:"colors__value",style:{backgroundColor:r.code},attrs:{title:r.title}})])])})),0)]),e("fieldset",{staticClass:"form__block"},[e("legend",{staticClass:"form__legend"},[t._v("Материал")]),e("ul",{staticClass:"check-list"},t._l(t.materials,(function(r){return e("li",{key:r.code,staticClass:"check-list__item"},[e("label",{staticClass:"check-list__label"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.checkedMaterials,expression:"checkedMaterials"}],staticClass:"check-list__check sr-only",attrs:{type:"checkbox",name:"material",disabled:t.isFilterLoading},domProps:{value:r.id,checked:Array.isArray(t.checkedMaterials)?t._i(t.checkedMaterials,r.id)>-1:t.checkedMaterials},on:{change:function(e){var s=t.checkedMaterials,a=e.target,i=!!a.checked;if(Array.isArray(s)){var o=r.id,n=t._i(s,o);a.checked?n<0&&(t.checkedMaterials=s.concat([o])):n>-1&&(t.checkedMaterials=s.slice(0,n).concat(s.slice(n+1)))}else t.checkedMaterials=i}}}),e("span",{staticClass:"check-list__desc"},[t._v(" "+t._s(r.title)+" "),e("span",[t._v("("+t._s(r.productsCount)+")")])])])])})),0)]),e("fieldset",{staticClass:"form__block"},[e("legend",{staticClass:"form__legend"},[t._v("Коллекция")]),e("ul",{staticClass:"check-list"},t._l(t.seasons,(function(r){return e("li",{key:r.code,staticClass:"check-list__item"},[e("label",{staticClass:"check-list__label"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.checkedSeasons,expression:"checkedSeasons"}],staticClass:"check-list__check sr-only",attrs:{type:"checkbox",name:"collection",disabled:t.isFilterLoading},domProps:{value:r.id,checked:Array.isArray(t.checkedSeasons)?t._i(t.checkedSeasons,r.id)>-1:t.checkedSeasons},on:{change:function(e){var s=t.checkedSeasons,a=e.target,i=!!a.checked;if(Array.isArray(s)){var o=r.id,n=t._i(s,o);a.checked?n<0&&(t.checkedSeasons=s.concat([o])):n>-1&&(t.checkedSeasons=s.slice(0,n).concat(s.slice(n+1)))}else t.checkedSeasons=i}}}),e("span",{staticClass:"check-list__desc"},[t._v(" "+t._s(r.title)+" "),e("span",[t._v("("+t._s(r.productsCount)+")")])])])])})),0)]),e("button",{staticClass:"filter__submit button button--primery",attrs:{type:"submit",disabled:t.isFilterLoading}},[e("span",[t._v("Применить")])]),e("button",{staticClass:"filter__reset button button--second",attrs:{type:"button",disabled:t.isFilterLoading},on:{click:function(e){return e.preventDefault(),t.resetForm.apply(null,arguments)}}},[t._v(" Сбросить ")])])])},W=[];const J="https://vue-moire.skillbox.cc",G=1e3,Q=25e4,X=99;var Y={name:"ProductFilter",props:["seasons","materials","categories","colors","isFilterLoading"],data(){return{currentPriceFrom:null,currentPriceTo:null,currentCategoryId:0,checkedSeasons:[],checkedMaterials:[],checkedColors:[]}},methods:{submitForm(){this.currentPriceTo<this.currentPriceFrom&&(this.currentPriceTo=Q),this.currentPriceFrom>this.currentPriceTo&&(this.currentPriceFrom=0);const t={categoryId:this.currentCategoryId,materialIds:this.checkedMaterials,seasonIds:this.checkedSeasons,colorIds:this.checkedColors,minPrice:this.validPriceFrom,maxPrice:this.validPriceTo};this.$emit("filter-update",t)},resetForm(){this.currentCategoryId=0,this.checkedMaterials=[],this.checkedSeasons=[],this.checkedColors=[],this.validPriceFrom=null,this.validPriceTo=Q,this.$emit("filter-update",{})}},computed:{validPriceFrom:{get(){return this.currentPriceFrom},set(t){t>0&&t<Q&&(this.currentPriceFrom=t)}},validPriceTo:{get(){return this.currentPriceTo},set(t){t>0&&t<Q&&(this.currentPriceTo=t)}}},created(){const t=this.$route?.params?.categoryId;t&&(this.$data.currentCategoryId=t)}},tt=Y,et=(0,o.Z)(tt,j,W,!1,null,null,null),rt=et.exports,st=function(){var t=this,e=t._self._c;return t.pagesCount?e("ul",{staticClass:"catalog__pagination pagination"},[e("li",{staticClass:"pagination__item"},[e("a",{staticClass:"pagination__link pagination__link--arrow",class:[{"pagination__link--disabled":1===t.pageCurrent}],attrs:{href:"#","aria-label":"Предыдущая страница"},on:{click:function(e){return e.preventDefault(),t.updatePageCurrent(t.pageCurrent-1,t.pageCurrent>1)}}},[e("svg",{attrs:{width:"8",height:"14",fill:"currentColor"}},[e("use",{attrs:{"xlink:href":"#icon-arrow-left"}})])])]),e("li",{staticClass:"pagination__item"},[e("a",{directives:[{name:"show",rawName:"v-show",value:t.isShowPrevDots,expression:"isShowPrevDots"}],staticClass:"pagination__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.updatePageCurrent(1,1!==t.pageCurrent)}}},[t._v(" 1 ")])]),e("li",{directives:[{name:"show",rawName:"v-show",value:t.isShowPrevDots,expression:"isShowPrevDots"}],staticClass:"pagination__item"},[e("a",{staticClass:"pagination__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.updatePageCurrent(t.pageCurrent-t.pagesCountToShow)}}},[t._v(" ... ")])]),t._l(t.pagesData.currentPagesArray,(function(r){return e("li",{key:r,staticClass:"pagination__item"},[e("a",{staticClass:"pagination__link",class:[{"pagination__link--current":r===t.pageCurrent}],attrs:{href:r!==t.pageCurrent&&"#"},on:{click:function(e){return e.preventDefault(),t.updatePageCurrent(r,r!==t.pageCurrent)}}},[t._v(" "+t._s(r)+" ")])])})),e("li",{directives:[{name:"show",rawName:"v-show",value:t.isShowNextDots,expression:"isShowNextDots"}],staticClass:"pagination__item"},[e("a",{staticClass:"pagination__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.updatePageCurrent(t.pageCurrent+t.pagesCountToShow)}}},[t._v(" ... ")])]),e("li",{staticClass:"pagination__item"},[e("a",{directives:[{name:"show",rawName:"v-show",value:t.isShowNextDots,expression:"isShowNextDots"}],staticClass:"pagination__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.updatePageCurrent(t.pagesCount,t.pageCurrent!==t.pagesCount)}}},[t._v(" "+t._s(t.lastPageIndex)+" ")])]),e("li",{staticClass:"pagination__item"},[e("a",{staticClass:"pagination__link pagination__link--arrow",class:[{"pagination__link--disabled":t.pageCurrent>=t.pagesCount}],attrs:{href:"#","aria-label":"Следующая страница"},on:{click:function(e){return e.preventDefault(),t.updatePageCurrent(t.pageCurrent+1,t.pageCurrent<t.pagesCount)}}},[e("svg",{attrs:{width:"8",height:"14",fill:"currentColor"}},[e("use",{attrs:{"xlink:href":"#icon-arrow-right"}})])])])],2):t._e()},at=[];function it(t,e=4){if("number"!==typeof t)throw new TypeError("createPagesArr: pagesCount should be a number!");if("number"!==typeof e)throw new TypeError("createPagesArr: pagesToShow should be a number!");let r=1;if(t<=e+1)return[new Array(e+1).fill(null).map((()=>r<=t?r++:null)).filter((t=>!!t))];const s=Math.ceil(t/e);let a=new Array(s).fill(new Array(e).fill(null));return a=a.map((e=>e.map((()=>r<=t?r++:null)))),a.map((t=>t.filter((t=>!!t))))}function ot(t,e){if("number"!==typeof e)throw new TypeError("getPagesArrIndex: сurrentPage should be a number!");let r=null;return t.forEach(((t,s)=>{t.includes(e)&&(r=s)})),r}var nt={name:"BasePagination",props:["pageCurrent","pagesCount"],data(){return{pagesCountToShow:4}},methods:{updatePageCurrent(t,e=!0){let r;r=t<1?1:t>this.pagesCount?this.pagesCount:t,e&&this.$emit("update:pageCurrent",r)}},computed:{lastPageIndex(){return this.pagesCount},isShowPrevDots(){return this.pagesCount===this.pagesCountToShow+1?this.pageCurrent>this.pagesCountToShow+1:this.pageCurrent>this.pagesCountToShow},isShowNextDots(){return this.pagesCount>this.pagesCountToShow+1&&this.pagesData.currentArrIndex!==this.pagesData.pagesArrs.length-1},pagesData(){const t=it(this.pagesCount,this.pagesCountToShow),e=ot(t,this.pageCurrent),r=t[e];return{pagesArrs:t,currentArrIndex:e,currentPagesArray:r}}}},lt=nt,ct=(0,o.Z)(lt,st,at,!1,null,null,null),ut=ct.exports;function dt(t,e){const r=[2,0,1,1,1,2],s=[`${t}`,`${t}а`,`${t}ов`];return s[e%100>4&&e%100<20?2:r[e%10<5?e%10:5]]}var _t=function(){var t=this,e=t._self._c;return e("div",{staticClass:"preloader",class:t.isItemPreloader?"preloader--item":"preloader--main"},[e("svg",{staticClass:"preloader__svg",attrs:{viewBox:"0 0 64 64"}},[e("circle",{staticClass:"preloader__circle",attrs:{cx:"32",cy:"32",r:"31",fill:"none","stroke-width":"2"}})])])},mt=[],pt={name:"BasePreloader",props:{isItemPreloader:{type:Boolean,default:!1}}},ht=pt,ft=(0,o.Z)(ht,_t,mt,!1,null,"79fa0b2a",null),gt=ft.exports,vt=r(7327),Ct=r(4161);class yt{constructor(t=J){return this._apiUrl=t,this._userAccessKey=null,this._axios=Ct.Z.create({baseURL:J,headers:"accept: application/json"}),this._cache={},yt._instance[this._apiUrl]||(yt._instance[this._apiUrl]=this),yt._instance[this._apiUrl]}async getColors(){return this._handleDelayedResponse((()=>this._axios.get("/api/colors")))}async getDeliveries(){return this._handleDelayedResponse((()=>this._axios.get("/api/deliveries")))}async getMaterials(){return this._handleDelayedResponse((()=>this._axios.get("/api/materials")))}async createOrder({phone:t,name:e,address:r,email:s,deliveryTypeId:a,paymentTypeId:i,comment:o}){return this._checkAccessKeyLSExist(),this._handleDelayedResponse((()=>this._axios.post("/api/orders",{phone:t,name:e,address:r,email:s,deliveryTypeId:a,paymentTypeId:i,comment:o},{params:{userAccessKey:this._userAccessKey}})))}async getOrderById(t){return this._checkAccessKeyLSExist(),this._handleDelayedResponse((()=>this._axios.get(`/api/orders/${t}`,{params:{userAccessKey:this._userAccessKey}})))}async getPaymentsById(t){return this._cacheIt("payments-by-"+t,(()=>this._handleDelayedResponse((()=>this._axios.get("/api/payments",{params:{deliveryTypeId:t}})))))}async getProductCategories(){return this._handleDelayedResponse((()=>this._axios.get("/api/productCategories")))}async getProducts({categoryId:t=0,materialIds:e=[],seasonIds:r=[],colorIds:s=[],page:a=1,limit:i=12,minPrice:o=0,maxPrice:n=0}={}){return this._handleDelayedResponse((()=>this._axios.get("/api/products",{params:{categoryId:t,materialIds:e,seasonIds:r,colorIds:s,page:a,limit:i,minPrice:o,maxPrice:n}})))}async getProductById(t){return this._handleDelayedResponse((()=>this._axios.get(`/api/products/${t}`)))}async getSeasons(){return this._handleDelayedResponse((()=>this._axios.get("/api/seasons")))}async getCartProducts(){return this._checkAccessKeyLSExist(),this._handleDelayedResponse((()=>this._axios.get("/api/baskets",{params:{userAccessKey:this._userAccessKey}})))}async createCartProduct({productId:t,colorId:e,sizeId:r,amount:s}){return this._checkAccessKeyLSExist(),this._handleDelayedResponse((()=>this._axios.post("/api/baskets/products",{productId:t,colorId:e,sizeId:r,quantity:s},{params:{userAccessKey:this._userAccessKey}})))}async updateCartProductAmount({itemId:t,newAmount:e}){return this._checkAccessKeyLSExist(),this._handleDelayedResponse((()=>this._axios.put("/api/baskets/products",{basketItemId:t,quantity:e},{params:{userAccessKey:this._userAccessKey}})))}async deleteCartProduct(t){return this._checkAccessKeyLSExist(),this._handleDelayedResponse((()=>this._axios.delete("/api/baskets/products",{data:{basketItemId:t},params:{userAccessKey:this._userAccessKey}})))}async getUserAccessKey(){return this._handleDelayedResponse((()=>this._axios("/api/users/accessKey")))}async _checkAccessKeyLSExist(){const t=localStorage.getItem("user-access-key");if(t)this._userAccessKey=t;else{const t=await this.getUserAccessKey();200===t.status&&t?.data?.accessKey&&(localStorage.setItem("user-access-key",t.data.accessKey),this._userAccessKey=t.data.accessKey)}}async _handleDelayedResponse(t){return new Promise(((e,r)=>{setTimeout((async()=>{try{const r=await t();e(r)}catch(s){r(s)}}),G)}))}async _cacheIt(t,e,...r){const s=t+JSON.stringify(r);return this._cache[s]||(this._cache[s]=await e(...r)),this._cache[s]}}(0,vt.Z)(yt,"_instance",{});var bt={name:"MainPage",components:{BaseHeader:I,BaseFooter:B,ProductItem:U,BasePagination:ut,BasePreloader:gt,ProductFilter:rt},data(){return{catalogPreloaderVisible:!1,products:[],seasons:[],materials:[],categories:[],colors:[],pageCurrent:1,pagesTotal:1,productsCount:0,categoryId:0,limit:12,currentFilter:{},isFilterLoading:!1}},methods:{handleFilterUpdate(t){this.currentFilter=t,this.loadProducts()},loadProducts(){this.catalogPreloaderVisible=!0,this.isFilterLoading=!0,(new yt).getProducts({page:this.pageCurrent,limit:this.limit,...this.currentFilter}).then((t=>{this.products=t.data.items,this.pagesTotal=t.data.pagination.pages,this.productsCount=t.data.pagination.total})).catch(console.log).finally((()=>{this.catalogPreloaderVisible=!1,this.isFilterLoading=!1}))},loadData(){const t=new yt;this.isFilterLoading=!0,Promise.all([!this.categories.length&&t.getProductCategories(),!this.materials.length&&t.getMaterials(),!this.seasons.length&&t.getSeasons(),!this.colors.length&&t.getColors()]).then((([t,e,r,s])=>{this.categories=t.data.items,this.materials=e.data.items,this.seasons=r.data.items,this.colors=s.data.items})).catch(console.log).finally((()=>{this.isFilterLoading=!1}))}},created(){const t=this.$route?.params?.categoryId;t&&(this.currentFilter.categoryId=t),this.loadProducts(),this.loadData()},watch:{pageCurrent(){this.loadProducts()}},filters:{normalizeWord:dt}},kt=bt,Pt=(0,o.Z)(kt,K,N,!1,null,null,null),wt=Pt.exports,It=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page__wrapper"},[e("BaseHeader"),e("main",{staticClass:"content container with-preloader"},[t.product?e("div",{staticClass:"content__top"},[e("ul",{staticClass:"breadcrumbs"},[e("li",{staticClass:"breadcrumbs__item"},[e("RouterLink",{staticClass:"breadcrumbs__link",attrs:{to:{name:"home"}}},[t._v(" Каталог ")])],1),e("li",{staticClass:"breadcrumbs__item"},[e("RouterLink",{staticClass:"breadcrumbs__link",attrs:{to:{name:"home",params:{categoryId:this.product?.category?.id}}}},[t._v(" "+t._s(t.product.category.title)+" ")])],1),e("li",{staticClass:"breadcrumbs__item"},[e("a",{staticClass:"breadcrumbs__link"},[t._v(" "+t._s(t.product.title)+" ")])])])]):t._e(),t.product?e("section",{staticClass:"item"},[e("div",{staticClass:"item__pics pics"},[e("div",{staticClass:"pics__wrapper"},[e("img",{attrs:{width:"570",height:"570",src:t.firstImage||"/img/product-placeholder.jpg",alt:t.product.title}})]),t.otherImages?e("ul",{staticClass:"pics__list"},t._l(t.otherImages,(function(r,s){return e("li",{key:r,staticClass:"pics__item"},[e("a",{staticClass:"pics__link pics__link--current",attrs:{href:""},on:{click:function(e){return e.preventDefault(),t.mixImages(s+1)}}},[e("img",{attrs:{width:"98",height:"98",src:r,alt:t.product.title}})])])})),0):t._e()]),e("div",{staticClass:"item__info"},[e("span",{staticClass:"item__code"},[t._v("Артикул: "+t._s(t.product.id))]),e("h2",{staticClass:"item__title"},[t._v(t._s(t.product.title))]),e("div",{staticClass:"item__form"},[e("form",{staticClass:"form",attrs:{action:"#",method:"POST"},on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[e("div",{staticClass:"item__row item__row--center"},[e("ProductCounter",{attrs:{"is-cart-counter":!1},model:{value:t.currentAmount,callback:function(e){t.currentAmount=t._n(e)},expression:"currentAmount"}}),e("b",{staticClass:"item__price"},[t._v(" "+t._s(t._f("numberFormat")(t.multAmount))+" ₽ ")])],1),e("div",{staticClass:"item__row"},[e("fieldset",{staticClass:"form__block"},[e("legend",{staticClass:"form__legend"},[t._v("Цвет")]),e("ul",{staticClass:"colors colors--black"},t._l(t.product.colors,(function(r){return e("li",{key:r.color.id,staticClass:"colors__item"},[e("label",{staticClass:"colors__label"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.currentColorId,expression:"currentColorId"}],staticClass:"colors__radio sr-only",attrs:{type:"radio",name:"color-item"},domProps:{value:r.color.id,checked:t._q(t.currentColorId,r.color.id)},on:{change:function(e){t.currentColorId=r.color.id}}}),e("span",{staticClass:"colors__value",style:{backgroundColor:r.color.code}})])])})),0)]),e("fieldset",{staticClass:"form__block"},[e("legend",{staticClass:"form__legend"},[t._v("Размер")]),e("label",{staticClass:"form__label form__label--small form__label--select"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.currentSizeId,expression:"currentSizeId"}],staticClass:"form__select",attrs:{type:"text",name:"sizes"},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.currentSizeId=e.target.multiple?r:r[0]}}},t._l(t.product.sizes,(function(r){return e("option",{key:r.id,domProps:{value:r.id}},[t._v(" "+t._s(r.title)+" ")])})),0)])])]),e("button",{staticClass:"item__button button button--primery",attrs:{type:"submit"}},[t._v(" В корзину ")])])])]),e("div",{staticClass:"item__desc"},[e("ul",{staticClass:"tabs"},[e("li",{staticClass:"tabs__item"},[e("a",{staticClass:"tabs__link",class:{"tabs__link--current":1===t.infoBlockToShow},attrs:{href:1!==t.infoBlockToShow&&"#"},on:{click:function(e){return e.preventDefault(),t.setInfoBlockToShow(1)}}},[t._v(" Информация о товаре ")])]),e("li",{staticClass:"tabs__item"},[e("a",{staticClass:"tabs__link",class:{"tabs__link--current":2===t.infoBlockToShow},attrs:{href:2!==t.infoBlockToShow&&"#"},on:{click:function(e){return e.preventDefault(),t.setInfoBlockToShow(2)}}},[t._v(" Доставка и возврат ")])])]),e("div",{directives:[{name:"show",rawName:"v-show",value:1===t.infoBlockToShow,expression:"infoBlockToShow === 1"}],staticClass:"item__content"},[e("h3",[t._v("Состав:")]),t._m(0),e("h3",[t._v("Уход:")]),t._m(1)]),e("div",{directives:[{name:"show",rawName:"v-show",value:2===t.infoBlockToShow,expression:"infoBlockToShow === 2"}],staticClass:"item__content"},[e("h3",[t._v("Доставка:")]),t._m(2),e("h3",[t._v("Возврат:")]),t._m(3)])])]):t._e(),this.product?t._e():e("BasePreloader")],1),e("BaseFooter")],1)},xt=[function(){var t=this,e=t._self._c;return e("p",[t._v(" 60% хлопок"),e("br"),t._v(" 30% полиэстер"),e("br")])},function(){var t=this,e=t._self._c;return e("p",[t._v(" Машинная стирка при макс. 30ºC короткий отжим"),e("br"),t._v(" Гладить при макс. 110ºC"),e("br"),t._v(" Не использовать машинную сушку"),e("br"),t._v(" Отбеливать запрещено"),e("br"),t._v(" Не подвергать химчистке"),e("br")])},function(){var t=this,e=t._self._c;return e("p",[t._v(" 1. Курьерская доставка по Москве и Московской области – 290 ₽"),e("br"),t._v(" 2.Самовывоз из магазина. Список и адреса магазинов Вы можете посмотреть здесь"),e("br")])},function(){var t=this,e=t._self._c;return e("p",[t._v(" Любой возврат должен быть осуществлен в течение Возвраты в магазине БЕСПЛАТНО."),e("br"),t._v(" Вы можете вернуть товары в любой магазин. Магазин должен быть расположен в стране, в которой Вы осуществили покупку. БЕСПЛАТНЫЙ возврат в Пункт выдачи заказов."),e("br"),t._v(" Для того чтобы вернуть товар в одном из наших Пунктов выдачи заказов, позвоните по телефону 8 800 600 90 09"),e("br")])}],Dt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"form__counter",class:t.isCartCounter&&"product__counter"},[e("button",{style:{cursor:t.currentAmount>1?"pointer":"not-allowed"},attrs:{type:"button","aria-label":"Убрать один товар",disabled:t.currentAmount<2},on:{click:function(e){return e.preventDefault(),t.subsAmount.apply(null,arguments)}}},[e("svg",{attrs:{width:t.isCartCounter?10:12,height:t.isCartCounter?10:12,fill:"currentColor"}},[e("use",{attrs:{"xlink:href":"#icon-minus"}})])]),e("label",[e("input",{directives:[{name:"model",rawName:"v-model.number.lazy",value:t.currentAmount,expression:"currentAmount",modifiers:{number:!0,lazy:!0}}],attrs:{id:"product-count",type:"number",min:"1",max:t.maxAmount},domProps:{value:t.currentAmount},on:{keydown:t.onMinusKeyDisable,change:function(e){t.currentAmount=t._n(e.target.value)},blur:function(e){return t.$forceUpdate()}}})]),e("button",{staticStyle:{cursor:"pointer"},style:{cursor:t.currentAmount>=t.maxAmount?"not-allowed":"pointer"},attrs:{type:"button","aria-label":"Добавить один товар",disabled:t.currentAmount>=t.maxAmount},on:{click:function(e){return e.preventDefault(),t.addAmount.apply(null,arguments)}}},[e("svg",{attrs:{width:t.isCartCounter?10:12,height:t.isCartCounter?10:12,fill:"currentColor"}},[e("use",{attrs:{"xlink:href":"#icon-plus"}})])])])},At=[],Ft={name:"ProductCounter",props:{isCartCounter:{type:Boolean,required:!1},value:{type:Number,required:!0}},data(){return{maxAmount:X}},computed:{currentAmount:{get(){return this.value},set(t){t<=X&&t>0&&this.$emit("input",t)}}},methods:{addAmount(){this.currentAmount<X&&this.currentAmount++},subsAmount(){this.currentAmount>1&&this.currentAmount--},onMinusKeyDisable(t){"-"===t.key&&t.preventDefault()}}},Lt=Ft,Bt=(0,o.Z)(Lt,Dt,At,!1,null,"e8288b52",null),St=Bt.exports,Tt={name:"ProductPage",components:{BaseHeader:I,BaseFooter:B,BasePreloader:gt,ProductCounter:St,RouterLink:u.rH},mixins:[E],data(){return{product:null,currentColorId:null,currentSizeId:null,currentAmount:1,infoBlockToShow:1}},methods:{...(0,g.nv)(["createCartProduct"]),onMinusKeyDisable(t){"-"===t.key&&t.preventDefault()},submit(){this.createCartProduct({product:this.product,colorId:this.currentColorId,sizeId:this.currentSizeId,amount:this.currentAmount})},setInfoBlockToShow(t){this.infoBlockToShow=t},addAmount(){this.currentAmount<99&&this.currentAmount++},subsAmount(){this.currentAmount>1&&this.currentAmount--},mixImages(t,e){const r=this.images[t][e],s=this.images[t].filter(((t,r)=>r!==e));s.unshift(r),this.images[t]=s}},watch:{currentAmount(t){t>0&&t<99&&(this.currentAmount=t)}},computed:{multAmount(){return this.currentAmount*this.product.price},images(){let t={};if(this.product){const e=this.product?.colors;e.forEach((e=>{Array.isArray(e?.gallery)&&e?.gallery?.length&&(t[e.color.id]=e.gallery.map((t=>t.file.url)))}))}return t},firstImage(){return this.images[this.currentColorId]&&this.images[this.currentColorId].length?this.images[this.currentColorId][0]:null},otherImages(){return this.images[this.currentColorId]&&this.images[this.currentColorId].length>1?this.images[this.currentColorId].slice(1):null}},created(){(new yt).getProductById(this.$route.params.id).then((t=>{this.product=t.data,this.currentSizeId=this.product.sizes[0].id,this.currentColorId=this.product.colors[0].color.id})).catch(console.log).finally((()=>{}))},filters:{numberFormat:V}},zt=Tt,Rt=(0,o.Z)(zt,It,xt,!1,null,null,null),Kt=Rt.exports,Nt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page__wrapper"},[e("BaseHeader"),e("main",{staticClass:"content container with-preloader"},[e("div",{staticClass:"content__top"},[e("ul",{staticClass:"breadcrumbs"},[e("li",{staticClass:"breadcrumbs__item"},[e("RouterLink",{staticClass:"breadcrumbs__link",attrs:{to:{name:"home"}}},[t._v(" Каталог ")])],1),t._m(0)]),e("div",{staticClass:"content__row"},[e("h1",{staticClass:"content__title"},[t._v("Корзина")]),e("span",{staticClass:"content__info"},[t._v(" "+t._s(t.productsLength)+" "+t._s(t._f("normalizeWord")("товар",t.productsLength))+" ")])])]),e("section",{staticClass:"cart"},[e("form",{staticClass:"cart__form form",attrs:{action:"#",method:"POST"},on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[e("div",{staticClass:"cart__field"},[e("ul",{staticClass:"cart__list"},t._l(t.productsForCartPage,(function(t){return e("CartItem",{key:t.itemId,attrs:{product:t}})})),1)]),e("div",{staticClass:"cart__block"},[e("p",{staticClass:"cart__desc"},[t._v(" Мы посчитаем стоимость доставки на следующем этапе ")]),e("p",{staticClass:"cart__price"},[t._v(" Итого: "),e("span",[t._v(" "+t._s(t._f("numberFormat")(t.totalAmount))+" ₽")])]),e("RouterLink",{staticClass:"cart__button button button--primery",attrs:{tag:"button",to:{name:"order"},disabled:t.cartBlocked||t.isSubmitDisabled}},[t._v(" Оформить заказ ")])],1)])]),t.cartLoading?e("BasePreloader"):t._e()],1),e("BaseFooter")],1)},Zt=[function(){var t=this,e=t._self._c;return e("li",{staticClass:"breadcrumbs__item"},[e("a",{staticClass:"breadcrumbs__link"},[t._v(" Корзина ")])])}],$t=function(){var t=this,e=t._self._c;return e("li",{staticClass:"cart__item product with-item-preloader"},[e("div",{staticClass:"product__pic"},[e("img",{staticClass:"product__img",attrs:{src:t.product.imgUrl,width:"120",height:"120",alt:t.product.title}})]),e("h3",{staticClass:"product__title"},[t._v(t._s(t.product.title))]),e("p",{staticClass:"product__info product__info--color"},[t._v(" Цвет: "),e("span",[e("i",{style:{backgroundColor:t.product.color.code,outline:"1px solid lightblue"}}),t._v(" "+t._s(t._f("colorFormat")(t.product.color.title))+" ")]),t._v(" Размер: "),e("span",[e("b",{staticClass:"product__size"},[t._v(" "+t._s(t.product.size.title)+" ")])])]),e("span",{staticClass:"product__code"},[t._v(" Артикул: "+t._s(t.product.id)+" ")]),e("ProductCounter",{attrs:{"is-cart-counter":!0},model:{value:t.amount,callback:function(e){t.amount=t._n(e)},expression:"amount"}}),e("b",{staticClass:"product__price"},[t._v(" "+t._s(t.multAmount)+" ₽ ")]),e("button",{staticClass:"product__del button-del interactive",attrs:{type:"button","aria-label":"Удалить товар из корзины"},on:{click:function(e){return e.preventDefault(),t.deleteItem.apply(null,arguments)}}},[e("svg",{attrs:{width:"20",height:"20",fill:"currentColor"}},[e("use",{attrs:{"xlink:href":"#icon-close"}})])]),t.product.isLoading?e("BasePreloader",{attrs:{"is-item-preloader":"true"}}):t._e()],1)},Vt=[];const Mt={white:"Белый",black:"Черный",red:"Красный",blue:"Синий",green:"Зеленый",yellow:"Желтый",purple:"Фиолетовый",pink:"Розовый"};function Et(t){const e=t.trim().toLowerCase();return Object.hasOwn(Mt,e)?Mt[e]:t}var Ot={name:"CartItem",components:{ProductCounter:St,BasePreloader:gt},props:["product"],data(){return{}},methods:{deleteItem(){this.$store.dispatch("deleteCartProduct",this.product.itemId)}},computed:{amount:{get(){return this.product.amount},set(t){this.$store.dispatch("updateCartProductAmount",{itemId:this.product.itemId,newAmount:t})}},multAmount(){return this.product.amount*this.product.price}},filters:{colorFormat:Et}},qt=Ot,Ht=(0,o.Z)(qt,$t,Vt,!1,null,"6d3833da",null),Ut=Ht.exports,jt={name:"CartPage",components:{BaseHeader:I,BaseFooter:B,BasePreloader:gt,CartItem:Ut,RouterLink:u.rH},computed:{...(0,g.Se)(["productsLength","totalAmount","cartLoading","productsForCartPage","cartBlocked"]),isSubmitDisabled(){return this.productsLength<1}},filters:{numberFormat:V,normalizeWord:dt}},Wt=jt,Jt=(0,o.Z)(Wt,Nt,Zt,!1,null,null,null),Gt=Jt.exports,Qt=function(){var t=this,e=t._self._c;return e("div",[e("BaseHeader"),e("main",{staticClass:"content container"},[e("div",{staticClass:"content__top"},[e("ul",{staticClass:"breadcrumbs"},[e("li",{staticClass:"breadcrumbs__item"},[e("RouterLink",{staticClass:"breadcrumbs__link",attrs:{to:{name:"home"}}},[t._v(" Каталог ")])],1),e("li",{staticClass:"breadcrumbs__item"},[t._v(' import BasePreloader from "@/components/BasePreloader.vue"; '),e("RouterLink",{staticClass:"breadcrumbs__link",attrs:{to:{name:"home"}}},[t._v(" Корзина ")])],1),t._m(0)]),t._m(1)]),e("section",{staticClass:"cart"},[e("form",{staticClass:"cart__form form",attrs:{action:"#",method:"POST"},on:{submit:function(e){return e.preventDefault(),t.submitFormHandler.apply(null,arguments)}}},[e("div",{staticClass:"cart__field"},[e("div",{staticClass:"cart__data"},[e("FormFieldInput",{attrs:{title:"ФИО",placeholder:"Введите ваше полное имя",error:t.formError.fio},model:{value:t.formData.fio,callback:function(e){t.$set(t.formData,"fio",e)},expression:"formData.fio"}}),e("FormFieldInput",{attrs:{title:"Адрес доставки",placeholder:"Введите ваш адрес",error:t.formError.addr},model:{value:t.formData.addr,callback:function(e){t.$set(t.formData,"addr",e)},expression:"formData.addr"}}),e("FormFieldInput",{attrs:{title:"Телефон",type:"tel",placeholder:"Введите ваш телефон",error:t.formError.tel},model:{value:t.formData.tel,callback:function(e){t.$set(t.formData,"tel",e)},expression:"formData.tel"}}),e("FormFieldInput",{attrs:{title:"Email",type:"email",placeholder:"Введи ваш Email",error:t.formError.email},model:{value:t.formData.email,callback:function(e){t.$set(t.formData,"email",e)},expression:"formData.email"}}),e("FormFieldTextarea",{attrs:{title:"Комментарий к заказу",placeholder:"Ваши пожелания",error:t.formError.comment},model:{value:t.formData.comment,callback:function(e){t.$set(t.formData,"comment",e)},expression:"formData.comment"}})],1),e("div",{staticClass:"cart__options"},[e("h3",{staticClass:"cart__title"},[t._v("Доставка")]),e("div",{staticClass:"with-item-preloader"},[t.deliveries.length?e("ul",{staticClass:"cart__options options"},t._l(t.deliveries,(function(r){return e("li",{key:r.title,staticClass:"options__item"},[e("label",{staticClass:"options__label"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.currentDelivery,expression:"currentDelivery"}],staticClass:"options__radio sr-only",attrs:{type:"radio",name:"delivery"},domProps:{value:r.id,checked:t._q(t.currentDelivery,r.id)},on:{change:function(e){t.currentDelivery=r.id}}}),e("span",{staticClass:"options__value"},[t._v(" "+t._s(r.title)+" "),0!=r.price?e("b",[t._v(t._s(t._f("numberFormat")(r.price))+" ₽")]):e("b",[t._v("бесплатно")])])])])})),0):t._e(),t.deliveries.length?t._e():e("BasePreloader",{attrs:{"is-item-preloader":""}})],1),t.currentDelivery?e("h3",{staticClass:"cart__title"},[t._v("Оплата")]):t._e(),t.currentDelivery?e("div",{staticClass:"with-item-preloader"},[t.payments.length&&!t.paymentsLoading?e("ul",{staticClass:"cart__options options"},t._l(t.payments,(function(r){return e("li",{key:r.title,staticClass:"options__item"},[e("label",{staticClass:"options__label"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.currentPayment,expression:"currentPayment"}],staticClass:"options__radio sr-only",attrs:{type:"radio",name:"payment"},domProps:{value:r.id,checked:t._q(t.currentPayment,r.id)},on:{change:function(e){t.currentPayment=r.id}}}),e("span",{staticClass:"options__value"},[t._v(" "+t._s(r.title)+" ")])])])})),0):t._e(),t.currentDelivery&&t.paymentsLoading?e("BasePreloader",{attrs:{"is-item-preloader":""}}):t._e()],1):t._e()])]),e("div",{staticClass:"cart__block"},[e("ul",{staticClass:"cart__orders"},t._l(t.productsForCartPage,(function(r){return e("li",{key:r.itemId,staticClass:"cart__order"},[e("h3",[t._v(" "+t._s(r.title)+" "),r.amount>1?e("span",[t._v("("+t._s(r.amount)+")")]):t._e()]),e("b",[t._v(t._s(t._f("numberFormat")(r.price*r.amount))+" ₽")]),e("div",{staticClass:"cart__order-info"},[e("i",{staticClass:"cart__order-color"},[t._v("Цвет:"),e("span",{style:{backgroundColor:r.color.code}})]),e("i",[t._v("Размер: "+t._s(r.size.title))])]),e("span",[t._v("Артикул: "+t._s(r.id))])])})),0),e("div",{staticClass:"cart__total"},[t.curDelivery.title?e("p",[t._v(" "+t._s(t.curDelivery.title)+": "),t.curDeliveryPrice?e("b",[t._v(t._s(t._f("numberFormat")(t.curDeliveryPrice)))]):e("b",[t._v("бесплатно")])]):t._e(),e("p",[t._v(" Итого: "),e("b",[t._v(t._s(t.productsLength))]),t._v(" "+t._s(t._f("normalizeWord")("товар",t.productsLength))+" на сумму "),e("b",[t._v(t._s(t._f("numberFormat")(t.totalAmount+t.curDeliveryPrice))+" ₽")])])]),e("button",{staticClass:"cart__button button button--primery",attrs:{type:"submit"}},[t._v(" Оформить заказ ")])]),t._m(2)])])]),e("BaseFooter")],1)},Xt=[function(){var t=this,e=t._self._c;return e("li",{staticClass:"breadcrumbs__item"},[e("a",{staticClass:"breadcrumbs__link"},[t._v(" Оформление заказа ")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"content__row"},[e("h1",{staticClass:"content__title"},[t._v("Оформление заказа")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"cart__error form__error-block"},[e("h4",[t._v("Заявка не отправлена!")]),e("p",[t._v(" Похоже произошла ошибка. Попробуйте отправить снова или перезагрузите страницу. ")])])}],Yt=function(){var t=this,e=t._self._c;return e("FormFieldWrap",{attrs:{title:t.title,error:t.error}},["checkbox"===t.type?e("input",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],staticClass:"form__input",attrs:{placeholder:t.placeholder,type:"checkbox"},domProps:{checked:Array.isArray(t.inputValue)?t._i(t.inputValue,null)>-1:t.inputValue},on:{change:function(e){var r=t.inputValue,s=e.target,a=!!s.checked;if(Array.isArray(r)){var i=null,o=t._i(r,i);s.checked?o<0&&(t.inputValue=r.concat([i])):o>-1&&(t.inputValue=r.slice(0,o).concat(r.slice(o+1)))}else t.inputValue=a}}}):"radio"===t.type?e("input",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],staticClass:"form__input",attrs:{placeholder:t.placeholder,type:"radio"},domProps:{checked:t._q(t.inputValue,null)},on:{change:function(e){t.inputValue=null}}}):e("input",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],staticClass:"form__input",attrs:{placeholder:t.placeholder,type:t.type},domProps:{value:t.inputValue},on:{input:function(e){e.target.composing||(t.inputValue=e.target.value)}}})])},te=[],ee=function(){var t=this,e=t._self._c;return e("label",{staticClass:"form__label"},[t._t("default"),e("span",{staticClass:"form__value"},[t._v(t._s(t.title))]),t.error?e("span",{staticClass:"form__error"},[t._v(t._s(t.error))]):t._e()],2)},re=[],se={name:"FormFieldWrap",props:{title:{type:String,required:!0,default:"title"},error:{type:String}}},ae=se,ie=(0,o.Z)(ae,ee,re,!1,null,null,null),oe=ie.exports,ne={components:{FormFieldWrap:oe},props:{type:{type:String,default:"text"},title:{type:String,required:!0},placeholder:{type:String},error:{type:String},value:{required:!0}},computed:{inputValue:{get(){return this.value},set(t){this.$emit("input",t)}}}},le={name:"FormFieldInput",props:{type:{type:String,default:"text"}},mixins:[ne]},ce=le,ue=(0,o.Z)(ce,Yt,te,!1,null,null,null),de=ue.exports,_e=function(){var t=this,e=t._self._c;return e("FormFieldWrap",{attrs:{title:t.title,error:t.error}},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],staticClass:"form__input form__input--area",attrs:{placeholder:t.placeholder},domProps:{value:t.inputValue},on:{input:function(e){e.target.composing||(t.inputValue=e.target.value)}}})])},me=[],pe={name:"FormFieldTextarea",mixins:[ne]},he=pe,fe=(0,o.Z)(he,_e,me,!1,null,null,null),ge=fe.exports,ve={name:"OrderPage",components:{BaseHeader:I,BaseFooter:B,BasePreloader:gt,RouterLink:u.rH,FormFieldInput:de,FormFieldTextarea:ge},data(){return{formData:{},formError:{},currentDelivery:0,currentPayment:0}},watch:{currentDelivery(t){t>0&&this.$store.dispatch("getPaymentsByDelivery",this.currentDelivery)}},methods:{submitFormHandler(){console.log("subm")}},computed:{...(0,g.Se)(["productsLength","totalAmount","cartLoading","productsForCartPage","cartBlocked","deliveriesLoading","deliveriesBlocked","deliveries","paymentsLoading","paymentsBlocked","payments"]),curDelivery(){return this.deliveries.find((t=>t.id===this.currentDelivery))||{price:0}},curDeliveryPrice(){return Number(this.curDelivery.price)},curDeliveryTitle(){return this.curDelivery.title}},filters:{numberFormat:V,normalizeWord:dt},created(){this.$store.dispatch("getDeliveries")}},Ce=ve,ye=(0,o.Z)(Ce,Qt,Xt,!1,null,"34bbe015",null),be=ye.exports;s.ZP.use(u.ZP);const ke=[{path:"/",name:"home",component:wt},{name:"cart",component:Gt,path:"/cart"},{name:"order",component:be,path:"/order"},{name:"product",component:Kt,path:"/product/:id"},{name:"notFound",component:R,path:"/:pathMatch(.*)*"}],Pe=new u.ZP({routes:ke});var we=Pe;r(7658);const Ie=new yt;let xe=[],De=[];function Ae(t,e=300){De.length&&De.forEach((t=>clearTimeout(t))),De.push(setTimeout((()=>{t()}),e))}var Fe={state:{cartProducts:[],user:null,cartId:null,isCartLoading:!1,isCartBlocked:!1},getters:{productsLength(t){return t.cartProducts.length},totalAmount(t){return t.cartProducts.reduce(((t,e)=>t+e.price*e.quantity),0)},cartBlocked(t){return t.isCartBlocked},cartLoading(t){return t.isCartLoading},productsForCartPage(t){return t.cartProducts.map((t=>({color:t.color.color,imgUrl:t.color?.gallery?.length?t.color.gallery[0].file.url:"img/product-placeholder.jpg",id:t.product.id,price:t.price,itemId:t.id,amount:t.quantity,size:t.size,title:t.product.title,isLoading:t.isLoading})))}},mutations:{setIsCartBlocked(t,e){t.isCartBlocked=e},setItemIsLoading(t,e){t.cartProducts.find((t=>t.id===e.id)).isLoading=e.isLoading},setCartIsLoading(t,e){t.isCartLoading=e},setProducts(t,e){t.cartProducts=e.map((t=>({...t,isLoading:!1})))},setUser(t,e){t.user=e},setCartId(t,e){t.cartId=e},addProduct(t,e){const r=t.cartProducts.find((t=>t.product.id===e.product.id&&t.color.id===e.color.id&&t.size.id===e.size.id));r?(r.id=e.id,r.quantity+=e.quantity):t.cartProducts.push(e)},deleteProduct(t,e){t.cartProducts=t.cartProducts.filter((t=>t.id!==e))},updateAmount(t,e){const r=t.cartProducts.find((t=>t.id===e.id));r&&(r.quantity=e.amount)}},actions:{async getCartProducts({commit:t}){t("setCartIsLoading",!0);try{const e=await Ie.getCartProducts();return t("setProducts",e.data.items),t("setUser",e.data.user),t("setCartId",e.data.id),e}catch(e){console.log("eeee",e)}finally{t("setCartIsLoading",!1)}},async createCartProduct({commit:t},{product:e,colorId:r,sizeId:s,amount:a}){const i={id:Date.now(),product:e,color:e.colors.find((t=>t.color.id===r)),size:e.sizes.find((t=>t.id===s)),quantity:a,price:e.prise};t("addProduct",i);try{const i=await Ie.createCartProduct({productId:e.id,colorId:r,sizeId:s,amount:a});t("setProducts",i.data.items)}catch(o){console.log("eeee",o),t("deleteProduct",i.id)}},async updateCartProductAmount({commit:t,state:e},{itemId:r,newAmount:s}){xe.push(e.cartProducts.find((t=>t.id===r)).quantity),t("updateAmount",{id:r,amount:s}),Ae((async()=>{try{await Ie.updateCartProductAmount({itemId:r,newAmount:s})}catch(e){console.log("error",e),xe.length&&(t("updateAmount",{id:r,amount:xe.shift()}),xe.length=0)}}))},async deleteCartProduct({commit:t},e){t("setItemIsLoading",{id:e,isLoading:!0}),Ae((async()=>{try{await Ie.deleteCartProduct(e),t("deleteProduct",e)}catch(r){console.log("errr",r)}}))}}};const Le=new yt;var Be={state:{isDeliveriesLoading:!1,isDeliveriesBlocked:!1,deliveriesData:[],isPaymentsLoading:!1,isPaymentsBlocked:!1,paymentsData:[]},getters:{deliveriesLoading(t){return t.isDeliveriesLoading},deliveriesBlocked(t){return t.isDeliveriesBlocked},deliveries(t){return t.deliveriesData},paymentsLoading(t){return t.isPaymentsLoading},paymentsBlocked(t){return t.isPaymentsBlocked},payments(t){return t.paymentsData}},mutations:{setIsDeliveriesLoading(t,e){t.isDeliveriesLoading=e},setIsDeliveriesBlocked(t,e){t.isDeliveriesBlocked=e},setDeliveries(t,e){t.deliveriesData=e},setIsPaymentsLoading(t,e){t.isPaymentsLoading=e},setIsPaymentsBlocked(t,e){t.isPaymentsBlocked=e},setPayments(t,e){t.paymentsData=e}},actions:{async getDeliveries({commit:t}){t("setIsDeliveriesLoading",!0),t("setIsDeliveriesBlocked",!0);try{const e=await Le.getDeliveries();t("setDeliveries",e.data)}catch(e){console.log("eeee",e)}finally{t("setIsDeliveriesLoading",!1),t("setIsDeliveriesBlocked",!1)}},async getPaymentsByDelivery({commit:t},e){t("setIsPaymentsLoading",!0),t("setIsPaymentsBlocked",!0);try{const r=await Le.getPaymentsById(e);t("setPayments",r.data)}catch(r){console.log("eeee",r)}finally{t("setIsPaymentsLoading",!1),t("setIsPaymentsBlocked",!1)}}}};s.ZP.use(g.ZP);var Se=new g.ZP.Store({modules:{cart:Fe,order:Be}});s.ZP.config.productionTip=!1,new s.ZP({router:we,store:Se,render:t=>t(c)}).$mount("#app")}},e={};function r(s){var a=e[s];if(void 0!==a)return a.exports;var i=e[s]={exports:{}};return t[s].call(i.exports,i,i.exports,r),i.exports}r.m=t,function(){var t=[];r.O=function(e,s,a,i){if(!s){var o=1/0;for(u=0;u<t.length;u++){s=t[u][0],a=t[u][1],i=t[u][2];for(var n=!0,l=0;l<s.length;l++)(!1&i||o>=i)&&Object.keys(r.O).every((function(t){return r.O[t](s[l])}))?s.splice(l--,1):(n=!1,i<o&&(o=i));if(n){t.splice(u--,1);var c=a();void 0!==c&&(e=c)}}return e}i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[s,a,i]}}(),function(){r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,{a:e}),e}}(),function(){r.d=function(t,e){for(var s in e)r.o(e,s)&&!r.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){r.p="/"}(),function(){var t={143:0};r.O.j=function(e){return 0===t[e]};var e=function(e,s){var a,i,o=s[0],n=s[1],l=s[2],c=0;if(o.some((function(e){return 0!==t[e]}))){for(a in n)r.o(n,a)&&(r.m[a]=n[a]);if(l)var u=l(r)}for(e&&e(s);c<o.length;c++)i=o[c],r.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return r.O(u)},s=self["webpackChunkmoire"]=self["webpackChunkmoire"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=r.O(void 0,[998],(function(){return r(6110)}));s=r.O(s)})();
//# sourceMappingURL=app.801aa687.js.map